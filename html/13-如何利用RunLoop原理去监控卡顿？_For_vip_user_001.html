<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>13-å¦‚ä½•åˆ©ç”¨RunLoopåŸç†å»ç›‘æ§å¡é¡¿ï¼Ÿ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>13-å¦‚ä½•åˆ©ç”¨RunLoopåŸç†å»ç›‘æ§å¡é¡¿ï¼Ÿ</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æˆ´é“­ã€‚ä»Šå¤©ï¼Œæˆ‘æ¥å’Œä½ è¯´è¯´å¦‚ä½•ç›‘æ§å¡é¡¿ã€‚</p><p>å¡é¡¿é—®é¢˜ï¼Œå°±æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šæ— æ³•å“åº”ç”¨æˆ·äº¤äº’çš„é—®é¢˜ã€‚å¦‚æœä¸€ä¸ª App æ—¶ä¸æ—¶åœ°å°±ç»™ä½ å¡ä¸€ä¸‹ï¼Œæœ‰æ—¶è¿˜é•¿æ—¶é—´æ— å“åº”ï¼Œè¿™æ—¶ä½ è¿˜æ„¿æ„ç»§ç»­ç”¨å®ƒå—ï¼Ÿæ‰€ä»¥è¯´ï¼Œå¡é¡¿é—®é¢˜å¯¹Appçš„ä¼¤å®³æ˜¯å·¨å¤§çš„ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¿…é¡»è¦é‡ç‚¹è§£å†³çš„ä¸€ä¸ªé—®é¢˜ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å¯¼è‡´å¡é¡¿é—®é¢˜çš„å‡ ç§åŸå› ï¼š</p><ul>
<li>å¤æ‚ UI ã€å›¾æ–‡æ··æ’çš„ç»˜åˆ¶é‡è¿‡å¤§ï¼›</li>
<li>åœ¨ä¸»çº¿ç¨‹ä¸Šåšç½‘ç»œåŒæ­¥è¯·æ±‚ï¼›</li>
<li>åœ¨ä¸»çº¿ç¨‹åšå¤§é‡çš„IO æ“ä½œï¼›</li>
<li>è¿ç®—é‡è¿‡å¤§ï¼ŒCPUæŒç»­é«˜å ç”¨ï¼›</li>
<li>æ­»é”å’Œä¸»å­çº¿ç¨‹æŠ¢é”ã€‚</li>
</ul><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•ç›‘æ§åˆ°ä»€ä¹ˆæ—¶å€™ä¼šå‡ºç°å¡é¡¿å‘¢ï¼Ÿæ˜¯è¦ç›‘è§† FPS å—ï¼Ÿ</p><p>ä»¥å‰ï¼Œæˆ‘ç‰¹åˆ«å–œæ¬¢ä¸€æœ¬å«ä½œã€Š24æ ¼ã€‹çš„æ‚å¿—ï¼Œå®ƒä¸»è¦ä»‹ç»çš„æ˜¯åŠ¨ç”»ç‰‡åˆ¶ä½œçš„ç›¸å…³å†…å®¹ã€‚é‚£ä¹ˆï¼Œå®ƒä¸ºå•¥å«24æ ¼å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼ŒåŠ¨ç”»ç‰‡ä¸­1ç§’é’Ÿä¼šç”¨åˆ°24å¼ å›¾ç‰‡ï¼Œè¿™æ ·è‚‰çœ¼çœ‹èµ·æ¥å°±æ˜¯æµç•…çš„ã€‚</p><p>FPS æ˜¯ä¸€ç§’æ˜¾ç¤ºçš„å¸§æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§’å†…ç”»é¢å˜åŒ–æ•°é‡ã€‚å¦‚æœæŒ‰ç…§åŠ¨ç”»ç‰‡æ¥è¯´ï¼ŒåŠ¨ç”»ç‰‡çš„ FPS å°±æ˜¯24ï¼Œæ˜¯è¾¾ä¸åˆ°60æ»¡å¸§çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºåŠ¨ç”»ç‰‡æ¥è¯´ï¼Œ24å¸§æ—¶è™½ç„¶æ²¡æœ‰60å¸§æ—¶æµç•…ï¼Œä½†ä¹Ÿå·²ç»æ˜¯è¿è´¯çš„äº†ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½è¯´24å¸§æ—¶å°±ç®—æ˜¯å¡ä½äº†ã€‚</p><p>ç”±æ­¤å¯è§ï¼Œç®€å•åœ°é€šè¿‡ç›‘è§† FPS æ˜¯å¾ˆéš¾ç¡®å®šæ˜¯å¦ä¼šå‡ºç°å¡é¡¿é—®é¢˜äº†ï¼Œæ‰€ä»¥æˆ‘å°±æœæ–­å¼ƒäº†é€šè¿‡ç›‘è§†FPS æ¥ç›‘æ§å¡é¡¿çš„æ–¹æ¡ˆã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬åˆ°åº•åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ–¹æ¡ˆæ¥ç›‘æ§å¡é¡¿å‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><h2>RunLoop åŸç†</h2><p>å¯¹äºiOSå¼€å‘æ¥è¯´ï¼Œç›‘æ§å¡é¡¿å°±æ˜¯è¦å»æ‰¾åˆ°ä¸»çº¿ç¨‹ä¸Šéƒ½åšäº†å“ªäº›äº‹å„¿ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œçº¿ç¨‹çš„æ¶ˆæ¯äº‹ä»¶æ˜¯ä¾èµ–äºNSRunLoop çš„ï¼Œæ‰€ä»¥ä»NSRunLoopå…¥æ‰‹ï¼Œå°±å¯ä»¥çŸ¥é“ä¸»çº¿ç¨‹ä¸Šéƒ½è°ƒç”¨äº†å“ªäº›æ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡ç›‘å¬ NSRunLoop çš„çŠ¶æ€ï¼Œå°±èƒ½å¤Ÿå‘ç°è°ƒç”¨æ–¹æ³•æ˜¯å¦æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä»è€Œåˆ¤æ–­å‡ºæ˜¯å¦ä¼šå‡ºç°å¡é¡¿ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘æ¨èçš„ç›‘æ§å¡é¡¿çš„æ–¹æ¡ˆæ˜¯ï¼šé€šè¿‡ç›‘æ§ RunLoop çš„çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦ä¼šå‡ºç°å¡é¡¿ã€‚</p><p>RunLoopæ˜¯iOSå¼€å‘ä¸­çš„ä¸€ä¸ªåŸºç¡€æ¦‚å¿µï¼Œä¸ºäº†å¸®åŠ©ä½ ç†è§£å¹¶ç”¨å¥½è¿™ä¸ªå¯¹è±¡ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šå…ˆå’Œä½ ä»‹ç»ä¸€ä¸‹å®ƒå¯ä»¥åšå“ªäº›äº‹å„¿ï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆå¯ä»¥åšæˆè¿™äº›äº‹å„¿ã€‚</p><p>RunLoopè¿™ä¸ªå¯¹è±¡ï¼Œåœ¨ iOS é‡Œç”±CFRunLoopå®ç°ã€‚ç®€å•æ¥è¯´ï¼ŒRunLoop æ˜¯ç”¨æ¥ç›‘å¬è¾“å…¥æºï¼Œè¿›è¡Œè°ƒåº¦å¤„ç†çš„ã€‚è¿™é‡Œçš„è¾“å…¥æºå¯ä»¥æ˜¯è¾“å…¥è®¾å¤‡ã€ç½‘ç»œã€å‘¨æœŸæ€§æˆ–è€…å»¶è¿Ÿæ—¶é—´ã€å¼‚æ­¥å›è°ƒã€‚RunLoop ä¼šæ¥æ”¶ä¸¤ç§ç±»å‹çš„è¾“å…¥æºï¼šä¸€ç§æ˜¯æ¥è‡ªå¦ä¸€ä¸ªçº¿ç¨‹æˆ–è€…æ¥è‡ªä¸åŒåº”ç”¨çš„å¼‚æ­¥æ¶ˆæ¯ï¼›å¦ä¸€ç§æ˜¯æ¥è‡ªé¢„è®¢æ—¶é—´æˆ–è€…é‡å¤é—´éš”çš„åŒæ­¥äº‹ä»¶ã€‚</p><p>RunLoop çš„ç›®çš„æ˜¯ï¼Œå½“æœ‰äº‹ä»¶è¦å»å¤„ç†æ—¶ä¿æŒçº¿ç¨‹å¿™ï¼Œå½“æ²¡æœ‰äº‹ä»¶è¦å¤„ç†æ—¶è®©çº¿ç¨‹è¿›å…¥ä¼‘çœ ã€‚æ‰€ä»¥ï¼Œäº†è§£ RunLoop åŸç†ä¸å…‰èƒ½å¤Ÿè¿ç”¨åˆ°ç›‘æ§å¡é¡¿ä¸Šï¼Œè¿˜å¯ä»¥æé«˜ç”¨æˆ·çš„äº¤äº’ä½“éªŒã€‚é€šè¿‡å°†é‚£äº›ç¹é‡è€Œä¸ç´§æ€¥ä¼šå¤§é‡å ç”¨ CPU çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚å›¾ç‰‡åŠ è½½ï¼‰ï¼Œæ”¾åˆ°ç©ºé—²çš„ RunLoop æ¨¡å¼é‡Œæ‰§è¡Œï¼Œå°±å¯ä»¥é¿å¼€åœ¨ UITrackingRunLoopMode è¿™ä¸ª RunLoop æ¨¡å¼æ—¶æ˜¯æ‰§è¡Œã€‚UITrackingRunLoopMode æ˜¯ç”¨æˆ·è¿›è¡Œæ»šåŠ¨æ“ä½œæ—¶ä¼šåˆ‡æ¢åˆ°çš„ RunLoop æ¨¡å¼ï¼Œé¿å…åœ¨è¿™ä¸ª RunLoop æ¨¡å¼æ‰§è¡Œç¹é‡çš„ CPU ä»»åŠ¡ï¼Œå°±èƒ½é¿å…å½±å“ç”¨æˆ·äº¤äº’æ“ä½œä¸Šä½“éªŒã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±é€šè¿‡ CFRunLoop çš„æºç æ¥è·Ÿä½ åˆ†äº«ä¸‹ RunLoop çš„åŸç†å§ã€‚</p><h3>ç¬¬ä¸€æ­¥</h3><p>é€šçŸ¥ observersï¼šRunLoop è¦å¼€å§‹è¿›å…¥ loop äº†ã€‚ç´§æ¥ç€å°±è¿›å…¥ loopã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>//é€šçŸ¥ observers
if (currentMode-&gt;_observerMask &amp; kCFRunLoopEntry ) 
    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopEntry);
//è¿›å…¥ loop
result = __CFRunLoopRun(rl, currentMode, seconds, returnAfterSourceHandled, previousMode);
</code></pre><h3>ç¬¬äºŒæ­¥</h3><p>å¼€å¯ä¸€ä¸ª do while æ¥ä¿æ´»çº¿ç¨‹ã€‚é€šçŸ¥ Observersï¼šRunLoop ä¼šè§¦å‘ Timer å›è°ƒã€Source0 å›è°ƒï¼Œæ¥ç€æ‰§è¡ŒåŠ å…¥çš„ blockã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>// é€šçŸ¥ Observers RunLoop ä¼šè§¦å‘ Timer å›è°ƒ
if (currentMode-&gt;_observerMask &amp; kCFRunLoopBeforeTimers)
    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeTimers);
// é€šçŸ¥ Observers RunLoop ä¼šè§¦å‘ Source0 å›è°ƒ
if (currentMode-&gt;_observerMask &amp; kCFRunLoopBeforeSources)
    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeSources);
// æ‰§è¡Œ block
__CFRunLoopDoBlocks(runloop, currentMode);
</code></pre><p>æ¥ä¸‹æ¥ï¼Œè§¦å‘ Source0 å›è°ƒï¼Œå¦‚æœæœ‰ Source1 æ˜¯ ready çŠ¶æ€çš„è¯ï¼Œå°±ä¼šè·³è½¬åˆ° handle_msgå»å¤„ç†æ¶ˆæ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>if (MACH_PORT_NULL != dispatchPort ) {
    Boolean hasMsg = __CFRunLoopServiceMachPort(dispatchPort, &amp;msg)
    if (hasMsg) goto handle_msg;
}
</code></pre><h3>ç¬¬ä¸‰æ­¥</h3><p>å›è°ƒè§¦å‘åï¼Œé€šçŸ¥ Observersï¼šRunLoopçš„çº¿ç¨‹å°†è¿›å…¥ä¼‘çœ ï¼ˆsleepï¼‰çŠ¶æ€ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>Boolean poll = sourceHandledThisLoop || (0ULL == timeout_context-&gt;termTSR);
if (!poll &amp;&amp; (currentMode-&gt;_observerMask &amp; kCFRunLoopBeforeWaiting)) {
    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeWaiting);
}
</code></pre><h3>ç¬¬å››æ­¥</h3><p>è¿›å…¥ä¼‘çœ åï¼Œä¼šç­‰å¾… mach_port çš„æ¶ˆæ¯ï¼Œä»¥å†æ¬¡å”¤é†’ã€‚åªæœ‰åœ¨ä¸‹é¢å››ä¸ªäº‹ä»¶å‡ºç°æ—¶æ‰ä¼šè¢«å†æ¬¡å”¤é†’ï¼š</p><ul>
<li>åŸºäº port çš„ Source äº‹ä»¶ï¼›</li>
<li>Timer æ—¶é—´åˆ°ï¼›</li>
<li>RunLoop è¶…æ—¶ï¼›</li>
<li>è¢«è°ƒç”¨è€…å”¤é†’ã€‚</li>
</ul><p>ç­‰å¾…å”¤é†’çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>do {
    __CFRunLoopServiceMachPort(waitSet, &amp;msg, sizeof(msg_buffer), &amp;livePort) {
        // åŸºäº port çš„ Source äº‹ä»¶ã€è°ƒç”¨è€…å”¤é†’
        if (modeQueuePort != MACH_PORT_NULL &amp;&amp; livePort == modeQueuePort) {
            break;
        }
        // Timer æ—¶é—´åˆ°ã€RunLoop è¶…æ—¶
        if (currentMode-&gt;_timerFired) {
            break;
        }
} while (1);
</code></pre><h3>ç¬¬äº”æ­¥</h3><p>å”¤é†’æ—¶é€šçŸ¥ Observerï¼šRunLoop çš„çº¿ç¨‹åˆšåˆšè¢«å”¤é†’äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>if (!poll &amp;&amp; (currentMode-&gt;_observerMask &amp; kCFRunLoopAfterWaiting))
    __CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopAfterWaiting);
</code></pre><h3>ç¬¬å…­æ­¥</h3><p>RunLoop è¢«å”¤é†’åå°±è¦å¼€å§‹å¤„ç†æ¶ˆæ¯äº†ï¼š</p><ul>
<li>å¦‚æœæ˜¯ Timer æ—¶é—´åˆ°çš„è¯ï¼Œå°±è§¦å‘ Timer çš„å›è°ƒï¼›</li>
<li>å¦‚æœæ˜¯ dispatch çš„è¯ï¼Œå°±æ‰§è¡Œ blockï¼›</li>
<li>å¦‚æœæ˜¯ source1äº‹ä»¶çš„è¯ï¼Œå°±å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚</li>
</ul><p>æ¶ˆæ¯æ‰§è¡Œå®Œåï¼Œå°±æ‰§è¡ŒåŠ åˆ° loop é‡Œçš„ blockã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>handle_msg:
// å¦‚æœ Timer æ—¶é—´åˆ°ï¼Œå°±è§¦å‘ Timer å›è°ƒ
if (msg-is-timer) {
    __CFRunLoopDoTimers(runloop, currentMode, mach_absolute_time())
} 
// å¦‚æœ dispatch å°±æ‰§è¡Œ block
else if (msg_is_dispatch) {
    __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__(msg);
} 

// Source1 äº‹ä»¶çš„è¯ï¼Œå°±å¤„ç†è¿™ä¸ªäº‹ä»¶
else {
    CFRunLoopSourceRef source1 = __CFRunLoopModeFindSourceForMachPort(runloop, currentMode, livePort);
    sourceHandledThisLoop = __CFRunLoopDoSource1(runloop, currentMode, source1, msg);
    if (sourceHandledThisLoop) {
        mach_msg(reply, MACH_SEND_MSG, reply);
    }
}
</code></pre><h3>ç¬¬ä¸ƒæ­¥</h3><p>æ ¹æ®å½“å‰ RunLoop çš„çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦èµ°ä¸‹ä¸€ä¸ª loopã€‚å½“è¢«å¤–éƒ¨å¼ºåˆ¶åœæ­¢æˆ–loop è¶…æ—¶æ—¶ï¼Œå°±ä¸ç»§ç»­ä¸‹ä¸€ä¸ª loop äº†ï¼Œå¦åˆ™ç»§ç»­èµ°ä¸‹ä¸€ä¸ª loop ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>if (sourceHandledThisLoop &amp;&amp; stopAfterHandle) {
     // äº‹ä»¶å·²å¤„ç†å®Œ
    retVal = kCFRunLoopRunHandledSource;
} else if (timeout) {
    // è¶…æ—¶
    retVal = kCFRunLoopRunTimedOut;
} else if (__CFRunLoopIsStopped(runloop)) {
    // å¤–éƒ¨è°ƒç”¨è€…å¼ºåˆ¶åœæ­¢
    retVal = kCFRunLoopRunStopped;
} else if (__CFRunLoopModeIsEmpty(runloop, currentMode)) {
    // mode ä¸ºç©ºï¼ŒRunLoop ç»“æŸ
    retVal = kCFRunLoopRunFinished;
}
</code></pre><p>æ•´ä¸ª RunLoop è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹æ‰€ç¤ºçš„ä¸€å¼ å›¾ç‰‡ã€‚<br>
<img src="https://static001.geekbang.org/resource/image/5f/7d/5f51c5e05085badb689f01b1e63e1c7d.png" alt=""></p><p>è¿™é‡Œåªåˆ—å‡ºäº† CFRunLoop çš„å…³é”®ä»£ç ï¼Œä½ å¯ä»¥ç‚¹å‡»<a href="https://opensource.apple.com/source/CF/CF-1153.18/CFRunLoop.c.auto.html">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹å®Œæ•´ä»£ç ã€‚</p><h3>loop çš„å…­ä¸ªçŠ¶æ€</h3><p>é€šè¿‡å¯¹RunLoopåŸç†çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œloopçš„çŠ¶æ€åŒ…æ‹¬6ä¸ªï¼Œå…¶ä»£ç å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>typedef CF_OPTIONS(CFOptionFlags, CFRunLoopActivity) {
    kCFRunLoopEntry , // è¿›å…¥ loop
    kCFRunLoopBeforeTimers , // è§¦å‘ Timer å›è°ƒ
    kCFRunLoopBeforeSources , // è§¦å‘ Source0 å›è°ƒ
    kCFRunLoopBeforeWaiting , // ç­‰å¾… mach_port æ¶ˆæ¯
    kCFRunLoopAfterWaiting ), // æ¥æ”¶ mach_port æ¶ˆæ¯
    kCFRunLoopExit , // é€€å‡º loop
    kCFRunLoopAllActivities  // loop æ‰€æœ‰çŠ¶æ€æ”¹å˜
}
</code></pre><p>å¦‚æœRunLoopçš„çº¿ç¨‹ï¼Œè¿›å…¥ç¡çœ å‰æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´è¿‡é•¿è€Œå¯¼è‡´æ— æ³•è¿›å…¥ç¡çœ ï¼Œæˆ–è€…çº¿ç¨‹å”¤é†’åæ¥æ”¶æ¶ˆæ¯æ—¶é—´è¿‡é•¿è€Œæ— æ³•è¿›å…¥ä¸‹ä¸€æ­¥çš„è¯ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯çº¿ç¨‹å—é˜»äº†ã€‚å¦‚æœè¿™ä¸ªçº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹çš„è¯ï¼Œè¡¨ç°å‡ºæ¥çš„å°±æ˜¯å‡ºç°äº†å¡é¡¿ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ©ç”¨RunLoopåŸç†æ¥ç›‘æ§å¡é¡¿çš„è¯ï¼Œå°±æ˜¯è¦å…³æ³¨è¿™ä¸¤ä¸ªé˜¶æ®µã€‚RunLoopåœ¨è¿›å…¥ç¡çœ ä¹‹å‰å’Œå”¤é†’åçš„ä¸¤ä¸ª loop çŠ¶æ€å®šä¹‰çš„å€¼ï¼Œåˆ†åˆ«æ˜¯ kCFRunLoopBeforeSources å’Œ kCFRunLoopAfterWaiting ï¼Œä¹Ÿå°±æ˜¯è¦è§¦å‘ Source0 å›è°ƒå’Œæ¥æ”¶ mach_port æ¶ˆæ¯ä¸¤ä¸ªçŠ¶æ€ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·åˆ†æä¸€ä¸‹ï¼Œå¦‚ä½•å¯¹loopçš„è¿™ä¸¤ä¸ªçŠ¶æ€è¿›è¡Œç›‘å¬ï¼Œä»¥åŠç›‘æ§çš„æ—¶é—´å€¼å¦‚ä½•è®¾ç½®æ‰åˆç†ã€‚</p><h2>å¦‚ä½•æ£€æŸ¥å¡é¡¿ï¼Ÿ</h2><p>è¦æƒ³ç›‘å¬ RunLoopï¼Œä½ å°±é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª CFRunLoopObserverContext è§‚å¯Ÿè€…ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>CFRunLoopObserverContext context = {0,(__bridge void*)self,NULL,NULL};
runLoopObserver = CFRunLoopObserverCreate(kCFAllocatorDefault,kCFRunLoopAllActivities,YES,0,&amp;runLoopObserverCallBack,&amp;context);
</code></pre><p>å°†åˆ›å»ºå¥½çš„è§‚å¯Ÿè€… runLoopObserver æ·»åŠ åˆ°ä¸»çº¿ç¨‹ RunLoop çš„ common æ¨¡å¼ä¸‹è§‚å¯Ÿã€‚ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªæŒç»­çš„å­çº¿ç¨‹ä¸“é—¨ç”¨æ¥ç›‘æ§ä¸»çº¿ç¨‹çš„ RunLoop çŠ¶æ€ã€‚</p><p>ä¸€æ—¦å‘ç°è¿›å…¥ç¡çœ å‰çš„ kCFRunLoopBeforeSources çŠ¶æ€ï¼Œæˆ–è€…å”¤é†’åçš„çŠ¶æ€ kCFRunLoopAfterWaitingï¼Œåœ¨è®¾ç½®çš„æ—¶é—´é˜ˆå€¼å†…ä¸€ç›´æ²¡æœ‰å˜åŒ–ï¼Œå³å¯åˆ¤å®šä¸ºå¡é¡¿ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ dump å‡ºå †æ ˆçš„ä¿¡æ¯ï¼Œä»è€Œè¿›ä¸€æ­¥åˆ†æå‡ºå…·ä½“æ˜¯å“ªä¸ªæ–¹æ³•çš„æ‰§è¡Œæ—¶é—´è¿‡é•¿ã€‚</p><p>å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹ç›‘æ§çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>//åˆ›å»ºå­çº¿ç¨‹ç›‘æ§
dispatch_async(dispatch_get_global_queue(0, 0), ^{
    //å­çº¿ç¨‹å¼€å¯ä¸€ä¸ªæŒç»­çš„ loop ç”¨æ¥è¿›è¡Œç›‘æ§
    while (YES) {
        long semaphoreWait = dispatch_semaphore_wait(dispatchSemaphore, dispatch_time(DISPATCH_TIME_NOW, 3 * NSEC_PER_SEC));
        if (semaphoreWait != 0) {
            if (!runLoopObserver) {
                timeoutCount = 0;
                dispatchSemaphore = 0;
                runLoopActivity = 0;
                return;
            }
            //BeforeSources å’Œ AfterWaiting è¿™ä¸¤ä¸ªçŠ¶æ€èƒ½å¤Ÿæ£€æµ‹åˆ°æ˜¯å¦å¡é¡¿
            if (runLoopActivity == kCFRunLoopBeforeSources || runLoopActivity == kCFRunLoopAfterWaiting) {
                //å°†å †æ ˆä¿¡æ¯ä¸ŠæŠ¥æœåŠ¡å™¨çš„ä»£ç æ”¾åˆ°è¿™é‡Œ
            } //end activity
        }// end semaphore wait
        timeoutCount = 0;
    }// end while
});
</code></pre><p>ä»£ç ä¸­çš„ NSEC_PER_SECï¼Œä»£è¡¨çš„æ˜¯è§¦å‘å¡é¡¿çš„æ—¶é—´é˜ˆå€¼ï¼Œå•ä½æ˜¯ç§’ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªé˜ˆå€¼è®¾ç½®æˆäº†3ç§’ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ª3ç§’çš„é˜ˆå€¼æ˜¯ä»ä½•è€Œæ¥å‘¢ï¼Ÿè¿™æ ·è®¾ç½®åˆç†å—ï¼Ÿ</p><p>å…¶å®ï¼Œè§¦å‘å¡é¡¿çš„æ—¶é—´é˜ˆå€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® WatchDog æœºåˆ¶æ¥è®¾ç½®ã€‚WatchDog åœ¨ä¸åŒçŠ¶æ€ä¸‹è®¾ç½®çš„ä¸åŒæ—¶é—´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul>
<li>å¯åŠ¨ï¼ˆLaunchï¼‰ï¼š20sï¼›</li>
<li>æ¢å¤ï¼ˆResumeï¼‰ï¼š10sï¼›</li>
<li>æŒ‚èµ·ï¼ˆSuspendï¼‰ï¼š10sï¼›</li>
<li>é€€å‡ºï¼ˆQuitï¼‰ï¼š6sï¼›</li>
<li>åå°ï¼ˆBackgroundï¼‰ï¼š3minï¼ˆåœ¨iOS 7ä¹‹å‰ï¼Œæ¯æ¬¡ç”³è¯·10minï¼› ä¹‹åæ”¹ä¸ºæ¯æ¬¡ç”³è¯·3minï¼Œå¯è¿ç»­ç”³è¯·ï¼Œæœ€å¤šç”³è¯·åˆ°10minï¼‰ã€‚</li>
</ul><p>é€šè¿‡WatchDog è®¾ç½®çš„æ—¶é—´ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥æŠŠå¯åŠ¨çš„é˜ˆå€¼è®¾ç½®ä¸º10ç§’ï¼Œå…¶ä»–çŠ¶æ€åˆ™éƒ½é»˜è®¤è®¾ç½®ä¸º3ç§’ã€‚æ€»çš„åŸåˆ™å°±æ˜¯ï¼Œè¦å°äº WatchDogçš„é™åˆ¶æ—¶é—´ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸ªé˜ˆå€¼ä¹Ÿä¸ç”¨å°å¾—å¤ªå¤šï¼ŒåŸåˆ™å°±æ˜¯è¦ä¼˜å…ˆè§£å†³ç”¨æˆ·æ„ŸçŸ¥æœ€æ˜æ˜¾çš„ä½“éªŒé—®é¢˜ã€‚</p><h2>å¦‚ä½•è·å–å¡é¡¿çš„æ–¹æ³•å †æ ˆä¿¡æ¯ï¼Ÿ</h2><p>å­çº¿ç¨‹ç›‘æ§å‘ç°å¡é¡¿åï¼Œè¿˜éœ€è¦è®°å½•å½“å‰å‡ºç°å¡é¡¿çš„æ–¹æ³•å †æ ˆä¿¡æ¯ï¼Œå¹¶é€‚æ—¶æ¨é€åˆ°æœåŠ¡ç«¯ä¾›å¼€å‘è€…åˆ†æï¼Œä»è€Œè§£å†³å¡é¡¿é—®é¢˜ã€‚é‚£ä¹ˆï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•è·å–å¡é¡¿çš„æ–¹æ³•å †æ ˆä¿¡æ¯å‘¢ï¼Ÿ</p><p><strong>è·å–å †æ ˆä¿¡æ¯çš„ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‡½æ•°ã€‚</strong>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹åœ¨äºï¼Œæ€§èƒ½æ¶ˆè€—å°ã€‚ä½†æ˜¯ï¼Œå®ƒåªèƒ½å¤Ÿè·å–ç®€å•çš„ä¿¡æ¯ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•é…åˆ dSYM æ¥è·å–å…·ä½“æ˜¯å“ªè¡Œä»£ç å‡ºäº†é—®é¢˜ï¼Œè€Œä¸”èƒ½å¤Ÿè·å–çš„ä¿¡æ¯ç±»å‹ä¹Ÿæœ‰é™ã€‚è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºæ€§èƒ½æ¯”è¾ƒå¥½ï¼Œæ‰€ä»¥é€‚ç”¨äºè§‚å¯Ÿå¤§ç›˜ç»Ÿè®¡å¡é¡¿æƒ…å†µï¼Œè€Œä¸æ˜¯æƒ³è¦æ‰¾åˆ°å¡é¡¿åŸå› çš„åœºæ™¯ã€‚</p><p>ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‡½æ•°æ–¹æ³•çš„ä¸»è¦æ€è·¯æ˜¯ï¼šç”¨ signal è¿›è¡Œé”™è¯¯ä¿¡æ¯çš„è·å–ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>static int s_fatal_signals[] = {
    SIGABRT,
    SIGBUS,
    SIGFPE,
    SIGILL,
    SIGSEGV,
    SIGTRAP,
    SIGTERM,
    SIGKILL,
};

static int s_fatal_signal_num = sizeof(s_fatal_signals) / sizeof(s_fatal_signals[0]);

void UncaughtExceptionHandler(NSException *exception) {
    NSArray *exceptionArray = [exception callStackSymbols]; //å¾—åˆ°å½“å‰è°ƒç”¨æ ˆä¿¡æ¯
    NSString *exceptionReason = [exception reason];       //éå¸¸é‡è¦ï¼Œå°±æ˜¯å´©æºƒçš„åŸå› 
    NSString *exceptionName = [exception name];           //å¼‚å¸¸ç±»å‹
}

void SignalHandler(int code)
{
    NSLog(@&quot;signal handler = %d&quot;,code);
}

void InitCrashReport()
{
    //ç³»ç»Ÿé”™è¯¯ä¿¡å·æ•è·
    for (int i = 0; i &lt; s_fatal_signal_num; ++i) {
        signal(s_fatal_signals[i], SignalHandler);
    }
    
    //ocæœªæ•è·å¼‚å¸¸çš„æ•è·
    NSSetUncaughtExceptionHandler(&amp;UncaughtExceptionHandler);
}

int main(int argc, char * argv[]) {
    @autoreleasepool {
        InitCrashReport();
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
</code></pre><p><strong>å¦ä¸€ç§æ–¹æ³•æ˜¯ï¼Œç›´æ¥ç”¨</strong> <a href="https://opensource.plausible.coop/src/projects/PLCR/repos/plcrashreporter/browse"><strong>PLCrashReporter</strong></a><strong>è¿™ä¸ªå¼€æºçš„ç¬¬ä¸‰æ–¹åº“æ¥è·å–å †æ ˆä¿¡æ¯ã€‚</strong>è¿™ç§æ–¹æ³•çš„ç‰¹ç‚¹æ˜¯ï¼Œèƒ½å¤Ÿå®šä½åˆ°é—®é¢˜ä»£ç çš„å…·ä½“ä½ç½®ï¼Œè€Œä¸”æ€§èƒ½æ¶ˆè€—ä¹Ÿä¸å¤§ã€‚æ‰€ä»¥ï¼Œä¹Ÿæ˜¯æˆ‘æ¨èçš„è·å–å †æ ˆä¿¡æ¯çš„æ–¹æ³•ã€‚</p><p>å…·ä½“å¦‚ä½•ä½¿ç”¨ PLCrashReporter æ¥è·å–å †æ ˆä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>// è·å–æ•°æ®
NSData *lagData = [[[PLCrashReporter alloc]
                                          initWithConfiguration:[[PLCrashReporterConfig alloc] initWithSignalHandlerType:PLCrashReporterSignalHandlerTypeBSD symbolicationStrategy:PLCrashReporterSymbolicationStrategyAll]] generateLiveReport];
// è½¬æ¢æˆ PLCrashReport å¯¹è±¡
PLCrashReport *lagReport = [[PLCrashReport alloc] initWithData:lagData error:NULL];
// è¿›è¡Œå­—ç¬¦ä¸²æ ¼å¼åŒ–å¤„ç†
NSString *lagReportString = [PLCrashReportTextFormatter stringValueForCrashReport:lagReport withTextFormat:PLCrashReportTextFormatiOS];
//å°†å­—ç¬¦ä¸²ä¸Šä¼ æœåŠ¡å™¨
NSLog(@&quot;lag happen, detail below: \n %@&quot;,lagReportString);
</code></pre><p>æœé›†åˆ°å¡é¡¿çš„æ–¹æ³•å †æ ˆä¿¡æ¯ä»¥åï¼Œå°±æ˜¯ç”±å¼€å‘è€…æ¥åˆ†æå¹¶è§£å†³å¡é¡¿é—®é¢˜äº†ã€‚</p><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„ä»ç›‘æ§å¡é¡¿åˆ°æ”¶é›†å¡é¡¿é—®é¢˜ä¿¡æ¯çš„å®Œæ•´ä»£ç ï¼Œä½ éƒ½å¯ä»¥ç‚¹å‡»<a href="https://github.com/ming1016/DecoupleDemo/blob/master/DecoupleDemo/SMLagMonitor.m">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©æˆ‘ç»™ä½ ä»‹ç»äº†ä½¿ç”¨ RunLoop ç›‘æ§å¡é¡¿çš„æ–¹æ¡ˆï¼Œæˆ‘è¿˜è·Ÿä½ è¯´äº†ä¸‹ RunLoop çš„åŸç†ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ RunLoop ç›‘æ§å¡é¡¿çš„æ–¹æ¡ˆã€‚</p><p>è¯»åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆè¦å°†å¡é¡¿ç›‘æ§æ”¾åˆ°çº¿ä¸Šåšå‘¢ï¼Ÿå…¶å®è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿæ›´å¤§èŒƒå›´çš„æ”¶é›†é—®é¢˜ï¼Œå¦‚æœä»…ä»…é€šè¿‡çº¿ä¸‹æ”¶é›†å¡é¡¿çš„è¯ï¼Œåœºæ™¯æ— æ³•è¢«å…¨é¢è¦†ç›–ã€‚å› ä¸ºï¼Œæ€»æœ‰ä¸€äº›å¡é¡¿é—®é¢˜ï¼Œæ˜¯ç”±äºå°‘æ•°ç”¨æˆ·çš„æ•°æ®å¼‚å¸¸å¯¼è‡´çš„ã€‚</p><p>è€Œç”¨æˆ·åé¦ˆçš„å¡é¡¿é—®é¢˜å¾€å¾€éƒ½æ˜¯è¯´åœ¨å“ªä¸ªé¡µé¢å¡ä½äº†ï¼Œè€Œå…·ä½“æ˜¯æ‰§è¡Œå“ªä¸ªæ–¹æ³•æ—¶å¡ä¸»äº†ï¼Œæˆ‘ä»¬æ˜¯æ— ä»å¾—çŸ¥çš„ã€‚åœ¨ç¢°åˆ°è¿™æ ·é—®é¢˜æ—¶ï¼Œä½ ä¸€å®šä¼šæ„Ÿè§‰æ‰‹è¶³æ— æªï¼Œå¿ƒä¸­åé—®ä¸€ç™¾éï¼šâ€œæˆ‘æ€ä¹ˆåœ¨è¿™ä¸ªé¡µé¢ä¸å¡ï¼Œæµ‹è¯•ä¹Ÿä¸å¡ï¼Œå°±ä½ å¡â€ã€‚è€Œä¸”ï¼Œé€šè¿‡æ—¥å¿—æˆ‘ä»¬ä¹Ÿå¾ˆéš¾æŸ¥å‡ºä¸ªç«¯å€ªã€‚è¿™æ—¶å€™ï¼Œçº¿ä¸Šç›‘æ§å¡é¡¿çš„é‡è¦æ€§å°±å‡¸æ˜¾å‡ºæ¥äº†ã€‚</p><p>æœ‰æ—¶ï¼ŒæŸä¸ªé—®é¢˜çœ‹ä¼¼å¯¹ App çš„å½±å“ä¸å¤§ï¼Œä½†å¦‚æœè¿™ä¸ªé—®é¢˜åœ¨æŸä¸ªç‰ˆæœ¬ä¸­çˆ†å‘å‡ºæ¥äº†å°±ä¼šå˜å¾—éš¾ä»¥æ”¶åœºã€‚æ‰€ä»¥ï¼Œä½ éœ€è¦å¯¹è¿™æ ·çš„é—®é¢˜è¿›è¡Œæœ‰é¢„è§æ€§çš„ç›‘æ§ï¼Œä¸€æ–¹é¢å¯ä»¥æ—©å‘ç°ã€æ—©è§£å†³ï¼Œå¦ä¸€æ–¹é¢åœ¨é‡åˆ°é—®é¢˜æ—¶èƒ½å¤Ÿå¿«é€Ÿå®šä½åŸå› ï¼Œä¸è‡³äºè¿‡äºè¢«åŠ¨ã€‚è¦çŸ¥é“ï¼Œé¢å¯¹é—®é¢˜çš„å“åº”é€Ÿåº¦å¾€å¾€æ˜¯è¯„åˆ¤åŸºç¡€å»ºè®¾ä¼˜åŠ£çš„ä¸€ä¸ªé‡è¦çš„æ ‡å‡†ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ä»Šå¤©çš„å†…å®¹äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘æƒ³è¯·ä½ å›é¡¾ä¸€ä¸‹ä½ éƒ½ç¢°åˆ°è¿‡å“ªäº›å¡é¡¿é—®é¢˜ï¼Œåˆæ˜¯å¦‚ä½•è§£å†³çš„å‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/f5/27/f5ee90aa0183a4bcc688980bd625eb27.jpg" alt=""></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Keep-Moving  2019-04-09 06:59:25
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            PLCrashReporteræ€ä¹ˆå’Œå¡é¡¿æ£€æµ‹ç»“åˆèµ·æ¥å‘¢ï¼Ÿæˆ‘ç†è§£å®ƒæ˜¯æ”¶é›†å´©æºƒä¿¡æ¯çš„ï¼Œä½†å¡é¡¿åˆä¸æ˜¯ä¸€å®šä¼šå´©æºƒ [8èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-09 14:31:32</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">å¡é¡¿åæ”¶é›†é€ æˆå¡é¡¿çš„åŸå› </div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Geek_a03ab1  2019-04-09 10:22:53
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ä¸ºä»€ä¹ˆç›‘æ§ kCFRunLoopBeforeSourcesã€kCFRunLoopAfterWaitingè¿™ä¸¤ä¸ªäº‹ä»¶å°±èƒ½åˆ¤æ–­å‡ºå¡é¡¿å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯kCFRunLoopBeforeWaitingã€kCFRunLoopAfterWaitingè¿™ä¸¤ä¸ªäº‹ä»¶å‘¢ï¼Ÿæ²¡æƒ³æ˜ç™½ï¼Œè€å¸ˆèƒ½å±•å¼€è¯´ä¸‹å—ï¼Ÿ [7èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            WeZZard  2019-04-10 11:14:52
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å–®ç´”ç›£æ§ FPS ç¢ºå¯¦ä¸è¡Œï¼Œå› ç‚ºå¾ˆå¤šå¡é “å…¶å¯¦æ˜¯ FPS è®ŠåŒ–ç‡çš„å¤§å¹…è®ŠåŒ–ï¼ˆæ—¢ FPS ä¸€éšå°æ•¸çš„æ³¢å‹•ï¼‰æ‰€é€ æˆçš„ã€‚<br><br>æ¯”å¦‚èªªé» A èŠ±ä¸€ç§’åŒ€é€Ÿä½ç§»è‡³é» Bï¼Œç§’é–“å¹³å‡å¹€ç‡ 60FPSï¼Œä½†æ˜¯å‰ 59&#47;60 ç§’æ‰è·‘äº†ä¸€å¹€å‡ºä¾†ï¼Œå‰©ä¸‹ 59 å¹€éƒ½åœ¨å¾Œ 1&#47;60 ç§’è·‘å‡ºä¾†ï¼Œé‚£éº¼ç”¨æˆ¶å¿…ç„¶çœ‹åˆ°çš„æ˜¯é» A èŠ±äº† 59&#47;60 ç§’åœåœ¨ A + ((B - A)&#47;60) é€™å€‹ä½ç½®ä¸Šï¼Œç„¶å¾Œçªç„¶ã€Œé£›ã€åˆ°äº† B é»ä¸Šã€‚<br><br>æ‰€ä»¥ç›£æ§ FPS &gt; 24 çš„åŒæ™‚é‚„è¦ç›£æ§ FPS è®ŠåŒ–ç‡çš„æ³¢å‹•ã€‚è€Œé€™å€‹æ³¢å‹•çš„æˆå› å…¶å¯¦å°±æ˜¯ä¸»ç·šç¨‹ä¸Šè¨ˆç®—ä»»å‹™çš„æ€§èƒ½è¡æ“Šã€‚ [3èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Wechat Team  2019-04-10 20:37:48
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æ–‡ç« æåˆ°å¯ä»¥ã€ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‡½æ•°ã€æ¥è·å–å †æ ˆï¼Œä½†æ˜¯é€šè¿‡æ³¨å†Œé‚£å‡ ä¸ªä¿¡å·çš„æ–¹å¼è·å–å †æ ˆï¼Œä¸€èˆ¬ä¸æ˜¯åœ¨é—ªé€€çš„æƒ…å†µä¸‹æ‰å¯ä»¥è§¦å‘å›è°ƒå—ï¼Ÿ<br>è¯·è€å¸ˆæŒ‡ç‚¹ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-13 15:19:02</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">è·å–å †æ ˆçš„æ–¹æ³•ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è°ƒçš„ã€‚é—ªé€€åªæ˜¯ä¸€ä¸ªæ—¶æœº</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            80åç©ºå·¢è€è‚¥ç‹—  2019-04-09 09:33:17
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è¿™ä¸ª3ç§’æ˜¯ä¸æ˜¯å¤ªé•¿äº†ï¼Œ1ç§’60å¸§ï¼Œæ¯å¸§16.67msã€‚runloooä¼šåœ¨æ¯æ¬¡sleepä¹‹å‰å»åˆ·æ–°uiï¼Œè¿™æ ·çš„è¯å¦‚æœæ‰äº†30å¸§ï¼Œå°±æ˜¯500mså·¦å³ï¼Œç”¨æˆ·çš„ä½“éªŒå°±å·²ç»ä¸‹å»äº†ï¼Œèƒ½æ„Ÿè§‰åˆ°å¡é¡¿äº†.<br> [1èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            é¹å“¥  2019-04-09 08:04:53
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œè¯·é—®ä¸‹ï¼Œå¦‚æœæˆ‘åœ¨ç”¨æˆ·æ»‘åŠ¨ç•Œé¢çš„æ—¶å€™ä¸å»åŠ è½½å›¾ç‰‡ï¼Œç­‰åœæ­¢æ»‘åŠ¨çš„æ—¶å€™å†å»åŠ è½½å›¾ç‰‡ï¼Œè¿™ä¸ªåœºæ™¯ç”¨runloopæˆ–è€…scrollviewçš„ä»£ç†æ¥å®ç°ï¼Œå’Œä½¿ç”¨sdwebimageå¼‚æ­¥ä¸‹è½½å›¾ç‰‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¿™å‡ ç§æ–¹å¼è²Œä¼¼éƒ½æ²¡æœ‰å½±å“ç”¨æˆ·æ»‘åŠ¨ä½“éªŒï¼ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-13 16:53:37</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">å›¾ç‰‡å°‘æ„Ÿè§‰ä¸å‡ºï¼Œå½“å›¾ç‰‡å¤§ã€åˆ—è¡¨é•¿ã€å¿«é€Ÿæ»šåŠ¨æ—¶ä¼šæœ‰åŒºåˆ«</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æˆ’æƒœèˆå¾—  2019-04-09 07:48:46
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¤§ç¥ å¯å¦æ¥ä¸€ç¯‡TDD oc å’Œswift å¸Œæœ›éƒ½æœ‰ [1èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å­å˜‰  2019-04-11 18:45:06
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ç³»ç»Ÿäº‹ä»¶æ˜¯é€šè¿‡source1ä¼ é€’æ¿€æ´»appçš„ ç„¶åé€šè¿‡source0åˆ†å‘å— è¿˜æ˜¯ç›´æ¥é€šè¿‡source0åˆ†å‘ï¼Ÿ æ¯”å¦‚ç‚¹å‡»å±å¹• åˆ°å“åº”  å¦‚æœæ˜¯ç¬¬äºŒä¸ª é‚£ä¹ˆåº”è¯¥æ¿€æ´»ä¸äº†å•Š.. 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            drunkenMouse  2019-04-11 15:15:58
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è§¦å‘Source0å›è°ƒï¼Œå¦‚æœæœ‰Source1æ˜¯readyçŠ¶æ€çš„è¯ï¼Œå°±ä¼šè·³è½¬åˆ°handle_msgå»å¤„ç†æ¶ˆæ¯ã€‚ä¸ºå•¥ï¼Ÿï¼Ÿæ‹¿sources0å½“å¤‡èƒï¼Ÿå…¶å®æ˜¯ä¸ºäº†æ¶ˆæ¯åˆ†æµï¼Œè®©sources1ä¹Ÿè·Ÿç€å¤„ç†å—ï¼Ÿ<br><br>åŸºäºportçš„Sourceäº‹ä»¶ï¼Ÿè¿™æ˜¯ä»€ä¹ˆäº‹ä»¶ä¸ä»€ä¹ˆåŸå› ã€‚ã€‚<br> 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            drunkenMouse  2019-04-11 14:44:30
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æƒ³èµ·ä»¥å‰é‡åˆ°è¿‡çš„å¡é¡¿æ•ˆæœï¼ŒçœŸçš„æ˜¯å‘å•Šã€‚<br><br>å°è±¡æœ€æ·±çš„ä¸€æ¬¡å¡é¡¿ï¼šåœ¨TableViewçš„Cellé‡Œè®¿é—®äº†æ•°æ®åº“ã€‚<br><br>å…¶æ¬¡æ˜¯åœ¨ä¸€ä¸ªç­”é¢˜ç³»ç»Ÿé‡Œï¼Œå¤šé€‰å•é€‰ä¸åˆ¤æ–­é¢˜ï¼Œä¸€ä¸ªCellä»æœ€å°‘ä¸¤ä¸ªé€‰é¡¹ã€ä¸€ä¸ªé€‰é¡¹ä¸‰åˆ°Nè¡Œï¼Œåˆ°æœ€å¤šä¹ä¸ªé€‰é¡¹ã€‚ç„¶åä½¿ç”¨äº†TableViewCellçš„é«˜åº¦è‡ªåŠ¨è®¡ç®—ï¼Œåæ¥æ¢æˆäº†è‡ªå·±æ‰‹åŠ¨è®¡ç®—å¹¶ç¼“å­˜ã€‚<br><br>è¿˜æœ‰Cellçš„æ ·å¼å¤ªå¤šï¼Œåæ¥æŠŠå°½å¯èƒ½ç›¸åŒçš„éƒ½æ”¾åˆ°ä¸€ä¸ªCellé‡Œï¼Œä¹Ÿå°±æ˜¯ï¼šä¸€ä¸ªCellæœ‰ä¸ƒè¡Œï¼Œå¦‚æœæœ‰å››è¡Œä¸æ˜¾ç¤ºï¼Œé‚£å°±ç§»é™¤å››è¡Œï¼Œå¦‚æœéœ€è¦ä¹è¡Œå°±å†åŠ ä¸¤è¡Œã€‚è¿˜æœ‰å°±æ˜¯ç½‘ç»œè¯·æ±‚åŒæ­¥æ“ä½œï¼Œç»“æœæ•°æ®è¿‡å¤§ï¼Œç„¶åå°±åšäº†å¼‚æ­¥å’Œæ— æ•°æ®çš„é»˜è®¤æ˜¾ç¤ºã€‚<br><br>å…¶å®æˆ‘å°±æ˜¯ä»è¿™å‡ ä¸ªæ–¹é¢ä¸‹æ‰‹çš„ï¼šé¡µé¢é‡å éƒ¨åˆ†ã€ç®€å•çš„åŠ¨ç”»ä¸æ˜¾ç¤ºç”¨CALayerè‡ªå·±ç”»ã€å¯¹è±¡é‡Šæ”¾ä¸åˆ›å»ºçš„æ¬¡æ•°ã€é«˜åº¦è‡ªåŠ¨ç¼“å­˜ã€autoReleaseä½¿ç”¨ã€staticä½¿ç”¨éƒ¨åˆ†ï¼ˆå¦‚å•åˆ—å¯¹è±¡ï¼‰ã€UIåˆ·æ–°å‰çš„æ•°æ®å¤„ç†éƒ¨åˆ†ã€é¡µé¢åˆ·æ–°æ¬¡æ•°ã€é€šçŸ¥å’Œç›‘å¬çš„ç§»é™¤ã€æ•°æ®çš„ä¸åˆç†è¯»å–ã€å¤æ‚æ“ä½œå°½é‡å¼‚æ­¥ã€<br><br>æœ€åæƒ³è¯´ä¸‹ï¼šçº¿ç¨‹çš„æ¶ˆæ¯ä¼ é€’ä¾èµ–äºNSRunLoopï¼Œå‡½æ•°çš„è°ƒç”¨ä¾èµ–runtimeã€‚æ„Ÿè§‰äºŒè€…æŒºåƒçš„ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            kidzss  2019-04-11 11:08:45
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆä½ å¥½ï¼Œæˆ‘ä¹‹å‰åšäº†ä¸€ä¸ªå¡é¡¿ç›‘æ§ï¼Œä¹Ÿæ˜¯ä½¿ç”¨äº†PLåº“ï¼Œä½†æ˜¯å‘ç°PLåº“æœ‰Crashçš„é—®é¢˜ã€‚<br>Out of memoryã€‚ã€‚ã€‚ã€‚ã€‚<br><br>GoodTransport +[PLCrashReportTextFormatter stringValueForCrashReport:withTextFormat:] (PLCrashReportTextFormatter.m:) 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Geek  2019-04-11 10:06:34
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¡é¡¿çš„åŸå› è®²çš„å¯ä»¥ï¼Œä½†æ˜¯è®²çš„RunLoopè®©æˆ‘å¬çš„å¤´å¤§ï¼Œæœ‰å‡ ä¸ªç–‘é—®è¯·æ•™è€å¸ˆï¼Œ<br>1ï¼Œçº¿ç¨‹ä¸run loopæ˜¯ä»€ä¹ˆå…³ç³»ã€‚<br>2ï¼Œmach_portæ˜¯ä»€ä¹ˆï¼Œç¬¬ä¸€æ¬¡è¿›å…¥runloopï¼Œä¹Ÿæ˜¯mach_portè§¦å‘çš„å—ï¼Œ<br>3.è¿›å…¥ä¼‘çœ çŠ¶æ€çš„runloopä¸ºä»€ä¹ˆè¦ç­‰mach_port.<br>4,ç³»ç»Ÿä¼šæœ‰å¤šä¸ªrunloopå—ï¼Œä¸åŒrunloopä¹‹é—´æ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            åºä½³æ˜Ÿ  2019-04-10 08:34:30
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¤§ï¼Œå•¥æ—¶å€™è®²è®²ï¼Œresct native  å’ŒiOSçš„å…³ç³»ã€‚è°¢è°¢å•¦ï¼Œ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-13 16:26:54</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">åé¢ä¼šä¸“é—¨è¯´</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Ant  2019-04-09 19:54:08
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ä»Šå¤©æ²¡ä½œä¸šçœŸæ˜¯çˆ½æ­ªæ­ª 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-13 16:28:21</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">æœ‰å•Šï¼ŒğŸ˜<br>æˆ‘æƒ³è¯·ä½ å›é¡¾ä¸€ä¸‹ä½ éƒ½ç¢°åˆ°è¿‡å“ªäº›å¡é¡¿é—®é¢˜ï¼Œåˆæ˜¯å¦‚ä½•è§£å†³çš„å‘¢ï¼Ÿ</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å¤§å®˜äºº  2019-04-09 08:01:50
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ä¸€ç›´è·Ÿç€å¬ï¼Œå—ç›ŠåŒªæµ…ï¼Œå­¦åˆ°å¾ˆå¤šä¹Ÿäº†è§£å¾ˆå¤šï¼Œå¦‚æœåªå¬ä¸åšï¼Œæ„Ÿè§‰éƒ½ä¼šäº†ï¼Œéƒ½çŸ¥é“ï¼Œä¸€åŠ¨æ‰‹ï¼Œå¡ä½äº†â€¦â€¦ï¼ŒåŠ¨æ‰‹æ‰ä¼šæ€è€ƒï¼Œ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Geek_cc73f2  2019-04-09 07:27:22
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆä½ å¥½ï¼Œä»æ–‡ç« çœŸçš„å—ç›ŠåŒªæµ…ï¼Œä»¥å‰åªä¼šç”¨ç¬¬ä¸‰æ–¹çš„ï¼Œç°åœ¨èƒ½ä»æœ¬è´¨çœ‹å‡ºç«¯å€ªï¼Œå¦å¤–èƒ½ä¸èƒ½ä»æºå¤´ç»™ä¸€äº›å»ºè®®å‘¢ï¼Œæ¯”å¦‚æ€ä¹ˆé¿å…å¡é¡¿ï¼Œå“ªäº›æ“ä½œå®¹æ˜“å¡é¡¿ï¼Œç„¶åæ€ä¹ˆå¤„ç†å‘¢ï¼Œæ„Ÿè°¢ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-09 14:30:55</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">æ–‡ç« æœ€å¼€å¤´éƒ¨åˆ†åˆè¯´åˆ°å®¹æ˜“é€ æˆå¡é¡¿çš„åŸå› </div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ğŸ€Ceezyï£¿  2019-04-09 02:35:59
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¯¹äºé‚£ä¸ª GCD çš„ dispatchPortï¼Œæˆ‘çœ‹æºç è²Œä¼¼æ˜¯ GCD æäº¤ç»™ä¸»çº¿ç¨‹çš„ä»»åŠ¡ï¼Œè¿™ä¸€äº‹ä»¶æºèƒ½ç§°ä¸º source1 å—ï¼Ÿ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>